{% extends "news/news.html" %}

{% block searchBox %}

    <div id="searchContainer" class="container">
        <h3 id="searchHeading">Teen<strong>HUB</strong><span class="subHeading">News</span></h3>
        <div id="searchBox" class="inner-addon right-addon">
          <i class="glyphicon glyphicon-search"></i>
          <input type="text" class="form-control lightGrayBg searchText" placeholder="Search" id="inputBox" />
        </div>
    </div>

{% endblock %}

{% block SearchedNews %}
    <div id="searchNews" class="container">

    </div>
{% endblock %}

{% block ajaxBlock %}

    <script type="text/javascript" src="../../static/js/jquery.min.js"></script>
    <script type="text/javascript">

    var slideIndex = 1;
    render_feed();

    $("#prev").click(function(){
         plusSlides(-1);
    });

    $("#next").click(function(){
        plusSlides(+1);
    });

    $("#link1").click(function(){
        currentSlides(1);
    });

    $("#link2").click(function(){
        currentSlides(2);
    });

    $("#link3").click(function(){
        currentSlides(3);
    });

    function plusSlides(n) {
        showSlides(slideIndex+=n);
    }

    function currentSlides(n){
        showSlides(slideIndex = n);
    }

    function showSlides(n) {
        var i;
        var navs = document.getElementsByClassName(' news-link');
        //console.log(navs.length);
        if(n > navs.length){
          slideIndex = 1;
        }
        if (n<1) {
          slideIndex = navs.length;
        }
        //console.log(navs);
        for (var i = 0; i < navs.length; i++) {
          navs[i].className=navs[i].className.replace(" current-app","");
        }
        //console.log(navs);
        navs[slideIndex-1].className += " current-app";

        render_feed();

    }

    function render_feed(){
        if(slideIndex==1){
            displayAll();
        }
        else if (slideIndex == 2) {
            displayEntertainment();
        }
        else if (slideIndex == 3) {
            displayTechnology();
        }
    }

    function displayAll(){
        $.ajax({
            method:"GET",
            url:"https://newsapi.org/v2/top-headlines?sources=buzzfeed,entertainment-weekly,mashable,mtv-news,the-lad-bible,polygon,ign,daily-mail,ars-technica,engadget,hacker-news,recode,gruenderszene,t3n,techcrunch,techradar,the-verge,the-next-web,wired,wired-de,crypto-coins-news&apiKey=c97376d8658b4d3ebd52b87297491737",
            dataType: "json",
            success: function(result){
                //console.log(result.articles);
                var articles = result.articles;
                var articleList="";
                $.each(articles,(index,article)=>{
                        // console.log(article.author);
                        // console.log(article.title);
                        // console.log(article.description);
                        // console.log(article.source.name);
                        // console.log(article.urlToImage);
                        // console.log(article.url);
                        // console.log("-------------");
                    if(article.urlToImage != "null"){
                        articleList += `
                            <div class="news-item"><a target="_blank" href="${article.url}">
                                <div class="news-item-image">
                                    <img class="news-image" src="${article.urlToImage}">
                                </div></a>
                                <div class="news-item-info">
                                    <a class="title" target="_blank" href="${article.url}">${article.title}</a>
                                    <div class="description"><p>${article.description}</p></div>
                                    <div class="other-detail" >
                                            <div class="source-name">${article.source.name}</div>
                                            <div class="published"">${article.publishedAt}</div>
                                    </div>
                                </div>
                            </div>
                            `;
                    }
                });
                {% if request.session.id %}
                  articleList += `    <div id="sourceNews">
                                        <h3>Entertainment &</h3>
                                        <h3>Technology</h3>
                                        <form action="{% url 'save_all_news_list' %}" method="post" Content-Type="application/json">
                                          {% csrf_token %}
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="buzzfeed" name="buzzfeed" checked>
                                            <label class="form-check-label" for="buzzfeed">
                                              Buzzfeed
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="daily-mail" name="daily_mail" checked>
                                            <label class="form-check-label" for="daily-mail">
                                              Daily Mail
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="entertainment-weekly" name="entertainment_weekly" checked>
                                            <label class="form-check-label" for="entertainment-weekly">
                                              Entertainment-Weekly
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="ign" name="ign" checked>
                                            <label class="form-check-label" for="ign">
                                              IGN
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="mashable" name="mashable" checked>
                                            <label class="form-check-label" for="mashable">
                                              Mashable
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="mtv-news" name="mtv_news" checked>
                                            <label class="form-check-label" for="mtv-news">
                                              MTV News
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="polygon" name="polygon" checked>
                                            <label class="form-check-label" for="polygon">
                                              Polygon
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="the-lad-bible" name="the_lad_bible" checked>
                                            <label class="form-check-label" for="the-lad-bible">
                                              The Lad Bible
                                            </label>
                                          </div>

                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="ars-technica" name="ars_technica" checked>
                                            <label class="form-check-label" for="ars-technica">
                                              Ars Technica
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="crypto-coins-news" name="crypto_coins_news" checked>
                                            <label class="form-check-label" for="crypto-coins-news">
                                              Crypto Coins News
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="engadget" name="engadget" checked>
                                            <label class="form-check-label" for="engadget">
                                              Engadget
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="gruenderszene" name="gruenderszene" checked>
                                            <label class="form-check-label" for="gruenderszene">
                                              Gruenderszene
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="hacker-news" name="hacker_news" checked>
                                            <label class="form-check-label" for="hacker-news">
                                              Hacker News
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="recode" name="recode" checked>
                                            <label class="form-check-label" for="recode">
                                              Recode
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="t3n" name="t3n" checked>
                                            <label class="form-check-label" for="t3n">
                                              T3n
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="techcrunch" name="techcrunch" checked>
                                            <label class="form-check-label" for="techcrunch">
                                              TechCrunch
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="techradar" name="techradar"  checked>
                                            <label class="form-check-label" for="techradar">
                                              TechRadar
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="the-next-web" name="the_next_web"  checked>
                                            <label class="form-check-label" for="the-next-web">
                                              The Next Web
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="the-verge" name="the_verge"  checked>
                                            <label class="form-check-label" for="the-verge">
                                              The Verge
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="wired" name="wired" checked>
                                            <label class="form-check-label" for="wired">
                                              Wired
                                            </label>
                                          </div>
                                          <button type="submit" class="btn btn-primary">Submit</button>
                                        </form
                                      </div>`;
                {% endif %}
                $("#searchNews").html(articleList);
            }
        });
    }


        function displayEntertainment(){
        $.ajax({
            method:"GET",
            url:"https://newsapi.org/v2/top-headlines?sources=buzzfeed,mashable,mtv-news,the-lad-bible,polygon,ign,daily-mail&apiKey=c97376d8658b4d3ebd52b87297491737",
            dataType: "json",
            success: function(result){
                //console.log(result.articles);
                var articles = result.articles;
                var articleList="";
                $.each(articles,(index,article)=>{
                        // console.log(article.author);
                        // console.log(article.title);
                        // console.log(article.description);
                        // console.log(article.source.name);
                        // console.log(article.urlToImage);
                        // console.log(article.url);
                        // console.log("-------------");
                    if(article.urlToImage != "null"){
                        articleList += `
                            <div class="news-item"><a target="_blank" href="${article.url}">
                                <div class="news-item-image">
                                    <img class="news-image" src="${article.urlToImage}">
                                </div></a>
                                <div class="news-item-info">
                                    <a class="title" target="_blank" href="${article.url}">${article.title}</a>
                                    <div class="description"><p>${article.description}</p></div>
                                    <div class="other-detail" >
                                            <div class="source-name">${article.source.name}</div>
                                            <div class="published"">${article.publishedAt}</div>
                                    </div>
                                </div>
                            </div>
                            `;
                    }
                });
                {% if request.session.id %}
                  articleList += `    <div id="sourceNews">
                                        <h3>Entertainment</h3>
                                        <form action="{% url 'save_entertain_news_list' %}" method="post" Content-Type="application/json">
                                          {% csrf_token %}
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="buzzfeed" name="buzzfeed" checked>
                                            <label class="form-check-label" for="buzzfeed">
                                              Buzzfeed
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="daily-mail" name="daily_mail" checked>
                                            <label class="form-check-label" for="daily-mail">
                                              Daily Mail
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="entertainment-weekly" name="entertainment_weekly" checked>
                                            <label class="form-check-label" for="entertainment-weekly">
                                              Entertainment-Weekly
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="ign" name="ign" checked>
                                            <label class="form-check-label" for="ign">
                                              IGN
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="mashable" name="mashable" checked>
                                            <label class="form-check-label" for="mashable">
                                              Mashable
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="mtv-news" name="mtv_news" checked>
                                            <label class="form-check-label" for="mtv-news">
                                              MTV News
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="polygon" name="polygon" checked>
                                            <label class="form-check-label" for="polygon">
                                              Polygon
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="the-lad-bible" name="the_lad_bible" checked>
                                            <label class="form-check-label" for="the-lad-bible">
                                              The Lad Bible
                                            </label>
                                          </div>
                                          <button type="submit" class="btn btn-primary">Submit</button>
                                        </form>


                                      </div>`;
                {% endif %}
                $("#searchNews").html(articleList);
            }
        });
    }

        function displayTechnology(){
        $.ajax({
            method:"GET",
            url:"https://newsapi.org/v2/top-headlines?sources=ars-technica,engadget,hacker-news,recode,gruenderszene,t3n,techcrunch-cn,techradar,the-verge,the-next-web,wired,wired-de,crypto-coins-news&apiKey=c97376d8658b4d3ebd52b87297491737",
            dataType: "json",
            success: function(result){
                //console.log(result.articles);
                var articles = result.articles;
                var articleList="";
                $.each(articles,(index,article)=>{
                        // console.log(article.author);
                        // console.log(article.title);
                        // console.log(article.description);
                        // console.log(article.source.name);
                        // console.log(article.urlToImage);
                        // console.log(article.url);
                        // console.log("-------------");
                    if(article.urlToImage != "null"){
                        articleList += `
                            <div class="news-item"><a target="_blank" href="${article.url}">
                                <div class="news-item-image">
                                    <img class="news-image" src="${article.urlToImage}">
                                </div></a>
                                <div class="news-item-info">
                                    <a class="title" target="_blank" href="${article.url}">${article.title}</a>
                                    <div class="description"><p>${article.description}</p></div>
                                    <div class="other-detail" >
                                            <div class="source-name">${article.source.name}</div>
                                            <div class="published"">${article.publishedAt}</div>
                                    </div>
                                </div>
                            </div>
                            `;
                    }
                });
                {% if request.session.id %}
                  articleList += `    <div id="sourceNews">

                                        <h3>Technology</h3>
                                        <form action="{% url 'save_tech_news_list' %}" method="post" Content-Type="application/json">
                                          {% csrf_token %}
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="ars-technica" name="ars_technica" checked>
                                            <label class="form-check-label" for="ars-technica">
                                              Ars Technica
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="crypto-coins-news" name="crypto_coins_news" checked>
                                            <label class="form-check-label" for="crypto-coins-news">
                                              Crypto Coins News
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="engadget" name="engadget" checked>
                                            <label class="form-check-label" for="engadget">
                                              Engadget
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="gruenderszene" name="gruenderszene" checked>
                                            <label class="form-check-label" for="gruenderszene">
                                              Gruenderszene
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="hacker-news" name="hacker_news" checked>
                                            <label class="form-check-label" for="hacker-news">
                                              Hacker News
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="recode" name="recode" checked>
                                            <label class="form-check-label" for="recode">
                                              Recode
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="t3n" name="t3n" checked>
                                            <label class="form-check-label" for="t3n">
                                              T3n
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="techcrunch" name="techcrunch" checked>
                                            <label class="form-check-label" for="techcrunch">
                                              TechCrunch
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="techradar" name="techradar"  checked>
                                            <label class="form-check-label" for="techradar">
                                              TechRadar
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="the-next-web" name="the_next_web"  checked>
                                            <label class="form-check-label" for="the-next-web">
                                              The Next Web
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="the-verge" name="the_verge"  checked>
                                            <label class="form-check-label" for="the-verge">
                                              The Verge
                                            </label>
                                          </div>
                                          <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="1" id="wired" name="wired" checked>
                                            <label class="form-check-label" for="wired">
                                              Wired
                                            </label>
                                          </div>
                                          <button type="submit" class="btn btn-primary">Submit</button>
                                        </form>
                                      </div>`;
                {% endif %}
                $("#searchNews").html(articleList);
            }
        });
    }





    let APIKEY = "c97376d8658b4d3ebd52b87297491737";

     $("#inputBox").keypress(function(e) {
         var key = e.keyCode;
         if(key == 13){
             var inputText = $("#inputBox").val();
             //console.log(inputText);
             $.ajax({
                 method:"GET",
                 url:"https://newsapi.org/v2/everything?q="+inputText+"&apiKey="+APIKEY,
                 dataType: "json",
                 success: function(result){
                     console.log(result.articles);
                     var articles = result.articles;
                     var articleList="";
                     $.each(articles,(index,article)=>{
                         // console.log(article.author);
                         // console.log(article.title);
                         // console.log(article.description);
                         // console.log(article.source.name);
                         // console.log(article.urlToImage);
                         // console.log(article.url);
                         // console.log("-------------");
                         if(article.urlToImage != "null"){
                             articleList += `
                             <div class="news-item"><a target="_blank" href="${article.url}">
                                 <div class="news-item-image">
                                     <img class="news-image" src="${article.urlToImage}">
                                 </div></a>
                                 <div class="news-item-info">
                                     <a class="title" target="_blank" href="${article.url}">${article.title}</a>
                                     <div class="description"><p>${article.description}</p></div>
                                     <div class="other-detail" >
                                             <div class="source-name">${article.source.name}</div>
                                             <div class="published"">${article.publishedAt}</div>
                                     </div>
                                 </div>
                             </div>
                             `;
                         }
                     });
                     $("#searchNews").html(articleList);
                 }
             });
        }
     });

    </script>

{% endblock %}
